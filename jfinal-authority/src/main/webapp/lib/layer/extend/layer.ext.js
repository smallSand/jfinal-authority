layer.use("skin/layer.ext.css",function(){layer.layui_layer_extendlayerextjs=!0}),layer.prompt=function(e,a){e=e||{},"function"==typeof e&&(a=e);var i,t=2==e.formType?'<textarea class="layui-layer-input">'+(e.value||"")+"</textarea>":function(){return'<input type="'+(1==e.formType?"password":"text")+'" class="layui-layer-input" value="'+(e.value||"")+'">'}();return layer.open($.extend({btn:["&#x786E;&#x5B9A;","&#x53D6;&#x6D88;"],content:t,skin:"layui-layer-prompt",success:function(e){i=e.find(".layui-layer-input"),i.focus()},yes:function(t){var n=i.val();""===n?i.focus():n.length>(e.maxlength||500)?layer.tips("&#x6700;&#x591A;&#x8F93;&#x5165;"+(e.maxlength||500)+"&#x4E2A;&#x5B57;&#x6570;",i,{tips:1}):a&&a(n,t,i)}},e))},layer.tab=function(e){e=e||{};var a=e.tab||{};return layer.open($.extend({type:1,skin:"layui-layer-tab",title:function(){var e=a.length,i=1,t="";if(e>0)for(t='<span class="layui-layer-tabnow">'+a[0].title+"</span>";e>i;i++)t+="<span>"+a[i].title+"</span>";return t}(),content:'<ul class="layui-layer-tabmain">'+function(){var e=a.length,i=1,t="";if(e>0)for(t='<li class="layui-layer-tabli xubox_tab_layer">'+(a[0].content||"no content")+"</li>";e>i;i++)t+='<li class="layui-layer-tabli">'+(a[i].content||"no  content")+"</li>";return t}()+"</ul>",success:function(e){var a=e.find(".layui-layer-title").children(),i=e.find(".layui-layer-tabmain").children();a.on("mousedown",function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0;var a=$(this),t=a.index();a.addClass("layui-layer-tabnow").siblings().removeClass("layui-layer-tabnow"),i.eq(t).show().siblings().hide()})}},e))},layer.photos=function(e,a,i){function t(e,a,i){var t=new Image;t.onload=function(){t.onload=null,a(t)},t.onerror=function(e){t.onload=null,i(e)},t.src=e}var n={};if(e=e||{},e.photos){var l=e.photos.constructor===Object,r=l?e.photos:{},o=r.data||[],s=r.start||0;if(n.imgIndex=s+1,l){if(0===o.length)return void layer.msg("&#x6CA1;&#x6709;&#x56FE;&#x7247;")}else{var u=$(e.photos),y=u.find(e.img||"img");if(0===y.length)return;if(a||u.find(r.img||"img").each(function(a){var i=$(this);o.push({alt:i.attr("alt"),pid:i.attr("layer-pid"),src:i.attr("layer-src")||i.attr("src"),thumb:i.attr("src")}),i.on("click",function(){layer.photos($.extend(e,{photos:{start:a,data:o,tab:e.tab},full:e.full}),!0)})}),!a)return}n.imgprev=function(e){n.imgIndex--,n.imgIndex<1&&(n.imgIndex=o.length),n.tabimg(e)},n.imgnext=function(e){n.imgIndex++,n.imgIndex>o.length&&(n.imgIndex=1),n.tabimg(e)},n.keyup=function(e){if(!n.end){var a=e.keyCode;e.preventDefault(),37===a?n.imgprev(!0):39===a?n.imgnext(!0):27===a&&layer.close(n.index)}},n.tabimg=function(a){r.start=n.imgIndex-1,layer.close(n.index),layer.photos({photos:r,full:e.full,tab:e.tab},!0,a)},n.event=function(){n.bigimg.hover(function(){n.imgsee.show()},function(){n.imgsee.hide()}),n.bigimg.find(".layui-layer-imgprev").on("click",function(e){e.preventDefault(),n.imgprev()}),n.bigimg.find(".layui-layer-imgnext").on("click",function(e){e.preventDefault(),n.imgnext()}),$(document).on("keyup",n.keyup)},n.loadi=layer.load(1,{shade:.9,scrollbar:!1}),t(o[s].src,function(a){layer.close(n.loadi),n.index=layer.open($.extend({type:1,area:function(){var i=[a.width,a.height],t=[$(window).width()-100,$(window).height()-100];return!e.full&&i[0]>t[0]&&(i[0]=t[0],i[1]=i[0]*t[1]/i[0]),[i[0]+"px",i[1]+"px"]}(),title:!1,shade:.9,shadeClose:!0,closeBtn:!1,move:".layui-layer-phimg img",moveType:1,scrollbar:!1,moveOut:!0,shift:5*Math.random()|0,skin:"layui-layer-photos",content:'<div class="layui-layer-phimg"><img src="'+o[s].src+'" alt="'+(o[s].alt||"")+'" layer-pid="'+o[s].pid+'"><div class="layui-layer-imgsee"><span class="layui-layer-imguide"><a href="javascript:;" class="layui-layer-iconext layui-layer-imgprev"></a><a href="javascript:;" class="layui-layer-iconext layui-layer-imgnext"></a></span><div class="layui-layer-imgbar" style="display:'+(i?"block":"")+'"><span class="layui-layer-imgtit"><a href="javascript:;">'+(o[s].alt||"")+"</a><em>"+n.imgIndex+"/"+o.length+"</em></span></div></div></div>",success:function(a){n.bigimg=a.find(".layui-layer-phimg"),n.imgsee=a.find(".layui-layer-imguide,.layui-layer-imgbar"),n.event(a),e.tab&&e.tab(o[s],a)},end:function(){n.end=!0,$(document).off("keyup",n.keyup)}},e))},function(){layer.close(n.loadi),layer.msg("&#x5F53;&#x524D;&#x56FE;&#x7247;&#x5730;&#x5740;&#x5F02;&#x5E38;",function(){o.length>1&&n.imgnext(!0)})})}};