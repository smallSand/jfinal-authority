;/*!/system/static/js/app.js*/
var duoshuoQuery={short_name:"jayqqaa12"},systemModule=angular.module("systemModule",[]),AdminApp=angular.module("AdminApp",["ngAnimate","ngSanitize","ui.select","ngTable","jbaseModule","systemModule"]);_uri=function(e){return""+e},AdminApp.run(["$rootScope","$state","$stateParams","$window",function(e,t,n,o){e.$state=t,e.$stateParams=n,e.$window=o,e.system={},e.app={},e.push={},e.go=function(e){o.location.href=e},e.delete=function(t){e.confirm=!0,e.delId=t},e.reset=function(t){e.ok=!1,e.confirm=!1,e.confirmBatch=!1,e.okBatch=!1,e.okWatch&&e.okWatch(),e.okWatch=e.$watch("ok",function(n){n&&(e.ok=!1,t&&t())})},e.hasPermission=function(t){return-1==e.urls.indexOf(t)?!0:-1!=e.auth_urls.indexOf(t)?!0:!1},e.$on("$stateChangeError",function(e,t,n,i,a,s){404==s.status&&(o.location.href="#/system/404"),401==s.status&&(o.location.href="/")})}]),AdminApp.config(["$translateProvider",function(e){e.useStaticFilesLoader({prefix:_uri("system/static/i18n/"),suffix:".json"}),e.preferredLanguage("zh_CH")}]),AdminApp.config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("login",{url:"/login",templateUrl:_uri("system/tpls/login.html")}).state("main",{url:"/:module/:name?id=",views:{"":{templateUrl:_uri("system/tpls/main.html")},"index@main":{templateUrl:function(e){return window.scrollTo(0,0),e.name||(e.name="index"),e.module||(e.module="system"),_uri("")+e.module+"/tpls/"+e.name+".html"}}}}),t.otherwise("/login")}]);
;/*!/system/static/js/bugCtrl.js*/
systemModule.controller("bugCtrl",["$scope","$rootScope","jbase","getMsg","api","NgTableParams",function(e,t,a,o,s,l){e.f={},t.reset(function(){s.bug.delete({id:t.delId},function(){e.tableParams.reload()})}),e.tableParams=new l({page:1,count:10,sortOrder:"desc",sortName:"date"},{getData:function(t,a){s.bug.list(a.$params,function(o){e.list=o.data.list,a.total(o.data.total),t.resolve(e.list)})}}),e.edit=function(t){e.f=t,e.editor.setValue(t.des)},e.save=function(){e.f.des=e.editor.getValue(),s.bug.save(e.f,function(){e.tableParams.reload(),e.clean()})},e.clean=function(){e.f={},e.editor.setValue("")}}]);
;/*!/system/static/js/directive.js*/
systemModule.directive("weather",function(){return{restrict:"A",link:function(t,e){var n={lang:{day:"白天",night:"夜晚",temp:"°C",wind:"级风",wangzimo:"12shu"},convert:function(t){var e={cloudy:["多云","多云转阴","晴转多云","阴转多云"],overcast:["阴","雾","沙尘暴","浮尘","扬沙","强沙尘暴"],rainy:["多云转小雨","小雨转多云","小雨","中雨","大雨","暴雨","大暴雨","特大暴雨","冻雨","小雨转中雨","中雨转大雨","大雨转暴雨","暴雨转大暴雨","大暴雨转特大暴雨","阵雨","雷阵雨","雷阵雨伴有冰雹"],sleet:["雨夹雪"],snow:["阵雪","小雪","中雪","大雪","暴雪","小雪转中雪","中雪转大雪","大雪转暴雪","中雪转小雪","大雪转中雪","暴雪转大雪"],sunshine:["晴"]},n="",r="";for(r in e)if($.inArray(t,e[r])>-1){n=r;break}return n||r||"sunshine"}};$.getScript("http://php.weather.sina.com.cn/iframe/index/w_cl.php?code=js&day=0&city=&charset=utf-8",function(){var t,r=window.SWther.w;for(var t in r);r=r[t][0];{var a={city:t,date:SWther.add.now.split(" ")[0]||"",day_weather:r.s1,night_weather:r.s2,day_temp:r.t1,night_temp:r.t2,day_wind:r.p1,night_wind:r.p2},i=new Date(SWther.add.now).getHours(),h=i>18?a.day_weather:a.night_weather;e.weather({sky:n.convert(h),weatherData:a,config:n})}})}}});
;/*!/system/static/js/errorCtrl.js*/
systemModule.controller("errorCtrl",["$scope","$rootScope","jbase","getMsg","api",function(o,r,e,t,l){l.log.error(function(r){o.log=r})}]);
;/*!/system/static/js/filter.js*/
systemModule.filter("optionType",function(){var t=function(t){return 1==t?"访问":2==t?"登录":3==t?"保存":5==t?"删除":void 0};return t}),systemModule.filter("userStatus",function(){var t=function(t){return 1==t?"正常":2==t?"冻结":void 0};return t});
;/*!/system/static/js/indexCtrl.js*/
systemModule.controller("indexCtrl",["$scope","$rootScope","jbase","getMsg","api",function(o,t,a,e,n){n.log.browser(function(t){o.browser=t.data}),n.log.data(function(t){o.data=t.data})}]);
;/*!/system/static/js/logCtrl.js*/
systemModule.controller('logCtrl', ['$scope','$rootScope', 'jbase','getMsg','api','NgTableParams',function($scope,$rootScope,jbase,getMsg,api,NgTableParams) {
    $scope.chart=false;
    $scope.tableParams = new NgTableParams({page: 1,  count: 10,sortOrder:'desc',sortName:'date'}, {
                  getData: function ($defer, params) {
                       api.log.list(params.$params, function(data){
                          $scope.list= data.data.list; 
                          params.total(data.data.total);
                          $defer.resolve($scope.list);
                     });   
                 }
               });
    $scope.showChart=function(){
         $scope.chart = !$scope.chart;
           api.log.chart(function(option){
                var myChart = echarts.init(document.getElementById('main'));
                myChart.setOption(option);
           });
    }
    $scope.setDate=function(){
        $scope.tableParams.$params.dateStart =$scope.dateStart; 
        $scope.tableParams.$params.dateEnd =$scope.dateEnd; 
        console.log('setdate');
    }
}]);
;/*!/system/static/js/loginCtrl.js*/
systemModule.controller("loginCtrl",["$scope","$rootScope","$timeout","$state","jbase","getMsg","api",function(e,o,a,c,n,l,i){e.remember=!1,e.click=!1,o.loadingTitle=l(Code.LOGING),e.changeCaptcha=function(){e.captchaUrl=i.login.captchaUrl()},e.changeCaptcha(),i.login.rsa(function(a){a.code==Code.LOGING?(e.msg=l(a.code),o.loading=!0,n.delay(function(){o.loading=!1},null,555)):(a.data.email&&(e.email=a.data.email,e.remember=!0),e.exponent=a.data.exponent,e.modulus=a.data.modulus)}),o.loadClosed=function(){c.go("main")},e.login=function(o){if(o&&o.preventDefault(),e.email&&e.pwd&&!e.click){e.click=!0;var a="email="+e.email+"&pwd="+e.pwd,t=n.rsa(e.exponent,e.modulus,a);i.login.login({key:t,remember:e.remember,code:e.code},function(o){200==o.code?c.go("main"):(e.changeCaptcha(),e.click=!1,e.msg=l(o.code),o.code==Code.CAPTCHA_ERROR&&(e.captcha=!0))})}}}]);
;/*!/system/static/js/mainCtrl.js*/
systemModule.controller("mainCtrl",["$scope","$rootScope","$state","$timeout","jbase","getMsg","api",function(o,e,l,n,t,r,u){e.loadingTitle=r(Code.LOADING),e.refresh=function(){u.res.tree(null,function(o){e.tree=o.data.tree}),u.res.urls(function(o){e.urls=o.data.urls,e.auth_urls=o.data.auth_urls})},e.loadClosed=function(){},t.AJAX_FAIL_CALLBACK=function(o,n){401==n?l.go("login"):403==n?layer.msg(r(n)):e.error=!0,console.log("fail callback  code="+n),layer.closeAll("loading")},e.user||(u.login.rsa(function(o){o.code!=Code.LOGING&&l.go("login"),e.user=o.data.user}),e.refresh()),o.logout=function(){u.login.logout(function(){l.go("login"),e.user=null})}}]);
;/*!/system/static/js/resCtrl.js*/
systemModule.controller("resCtrl",["$scope","$rootScope","$stateParams","$window","api","D","jbase","$filter","NgTableParams",function(e,t,i,n,c,o,s,a,l){i.id&&(e.showBack=!0),e.icons=o.icons,e.f={},t.reset(function(){c.res.delete({id:e.delId},function(){e.getList({id:i.id}),t.refresh()})}),e.tableParams=new l({page:1,count:100},{counts:[],getData:function(t){t.resolve(e.list)}}),e.getList=function(t){c.res.list(t,function(t){e.list=t.data.list,e.parent=t.data.parent,e.tableParams.reload()})},e.getList({id:i.id}),e.go=function(e){n.location.href="#/system/res?id="+e},e.back=function(){n.history.back()},e.post=function(){e.f.iconCls=e.f.icon.name,e.f.icon=null;var n=s.toParam("res",e.f,["childSize"]);c.res.save(n,function(){e.showModal=!1,e.getList({id:i.id}),t.refresh()})},e.edit=function(t){e.f=s.find("id",t,e.list),e.f.icon={name:e.f.iconCls},e.title="编辑",e.showModal=!0},e.add=function(){e.f={seq:10,type:1,icon:{name:"am-icon-folder"}},e.parent&&(e.f.pid=e.parent.id),e.showModal=!0,e.title="添加"},e.delete=function(i){t.confirm=!0,e.delId=i},e.batchDelete=function(){var n=[];angular.forEach(e.checkboxes.items,function(e,t){e&&n.push(t)}),0!=n.length&&(t.confirmBatch=!0,t.$watch("okBatch",function(o){o&&c.res.batchDelete({ids:n.join(",")},function(){e.getList({id:i.id}),t.refresh()})}))},e.checkboxes={checked:!1,items:{}},e.$watch("checkboxes.checked",function(t){angular.forEach(e.list,function(i){angular.isDefined(i.id)&&(e.checkboxes.items[i.id]=t)})}),e.$watch("checkboxes.items",function(){if(e.list){var t=0,i=0,n=e.list.length;angular.forEach(e.list,function(n){t+=e.checkboxes.items[n.id]||0,i+=!e.checkboxes.items[n.id]||0}),(0==i||0==t)&&(e.checkboxes.checked=t==n),angular.element(document.getElementById("select_all")).prop("indeterminate",0!=t&&0!=i)}},!0)}]);
;/*!/system/static/js/roleCtrl.js*/
systemModule.controller("roleCtrl",["$scope","$rootScope","$filter","api","jbase","NgTableParams",function(e,t,r,s,o,a){t.reset(function(){s.role.delete({id:t.delId},function(){e.tableParams.reload(),t.refresh()})}),e.tableParams=new a({page:1,count:100},{getData:function(t){s.role.list(function(s){s=r("orderBy")(s,"seq"),e.list=s,t.resolve(e.list)})}}),e.edit=function(r){var s=o.find("id",r.id,e.list);delete s.res_names,t.system.role=s,t.go("#/system/role.edit?id="+r.id)}}]),systemModule.controller("roleEditCtrl",["$scope","$rootScope","$filter","api","jbase",function(e,t,r,s,o){e.f={},e.title="添加角色",e.ztree={},t.$stateParams.id&&(e.f=t.system.role,e.readonly=!0),e.submit=function(){var r=e.ztree.getCheckedNodes(!0);e.f.res_ids=o.toArray("id",r).join(","),e.f.pname=null,s.role.save(e.f,function(){t.refresh(),t.go("#/system/role")})},s.res.ztree(function(t){if(e.setting={view:{selectedMulti:!1},check:{enable:!0},data:{simpleData:{enable:!0}}},e.f.res_ids){var r=e.f.res_ids.split(",");for(var s in t.data.ztree)for(var o in r)t.data.ztree[s].id==r[o]&&(t.data.ztree[s].checked=!0)}e.znodes=t.data.ztree})}]);
;/*!/system/static/js/service.js*/
Code={LOADING:101,LOGING:102,NULL:404,ERROR:500,RELOGIN:1001,USER_NOT_EXIT:1003,USER_PWD_ERROR:1004,USER_FRRZE:1005,USER_ATTEMPT:1006,USER_AUTH:1007,EMAIL_VAL_ERROR:1100,EMAIL_EXIT:1101,CAPTCHA_ERROR:1200,FILE_TYPE_ERROR:11e3,IMG_SIZE_ERROR:12e3,APK_ERROR:13e3,PUSH_ERROR:9e3},systemModule.factory("getMsg",[function(){var e=function(e){return e==Code.LOADING?"正在加载...":e==Code.ERROR?"服务器错误":403==e?"没有操作权限 请联系管理员":e==Code.USER_NOT_EXIT?"用户不存在":e==Code.USER_PWD_ERROR?"用户名或密码错误":e==Code.USER_FRRZE?"用户被封了":e==Code.USER_ATTEMPT?"密码错误次数太多,请一小时后再试":e==Code.USER_AUTH?"没有权限":e==Code.LOGING?"已经登录过正在自动登录...":e==Code.EMAIL_VAL_ERROR?"邮箱验证错误":e==Code.EMAIL_EXIT?"邮箱已经存在了":e==Code.IMG_SIZE_ERROR?"图片大小错误":e==Code.APK_ERROR?"apk解析错误请重新上传":e==Code.FILE_TYPE_ERROR?"文件上传类型错误":e==Code.CAPTCHA_ERROR?"验证码错误":e==Code.PUSH_ERROR?"推送设置错误请检查":void 0};return e}]),systemModule.factory("api",["$rootScope","jbase","getMsg",function(e,a,n){var o={post:function(o,m,i){layer.load(),a.post(o,m,function(a){500==a.code?e.error=!0:a.code>200&&(e.warn=!0,layer.msg(n(a.code))),i&&i(a),layer.closeAll("loading")})},upload:function(o,m,i,c,t){return o.target.files.length>0&&-1==o.target.files[0].name.indexOf(t)?void layer.msg(n(Code.FILE_TYPE_ERROR)):void a.upload(o,m,i,function(a){500==a.code?e.error=!0:a.code>200&&(e.warn=!0,layer.msg(n(a.code))),c&&c(a)})},login:{captchaUrl:function(){return _uri("captcha?time=")+(new Date).getTime()},logout:function(e){o.post(_uri("logout"),null,e)},login:function(e,a){o.post(_uri("login"),e,a)},rsa:function(e){o.post(_uri("rsa"),null,e)}},res:{urls:function(e){o.post(_uri("system/res/urls"),null,e)},ztree:function(e){o.post(_uri("system/res/ztree"),null,e)},tree:function(e,a){o.post(_uri("system/res/tree"),e,a)},list:function(e,a){o.post(_uri("system/res/list"),e,a)},save:function(e,a){o.post(_uri("system/res/save"),e,a)},"delete":function(e,a){o.post(_uri("system/res/delete"),e,a)},batchDelete:function(e,a){o.post(_uri("system/res/batchDelete"),e,a)}},role:{list:function(e){o.post(_uri("system/role/list"),null,e)},save:function(e,n){var m=a.toParam("role",e,["res_ids"]);o.post(_uri("system/role/save"),m,n)},"delete":function(e,a){o.post(_uri("system/role/delete"),e,a)}},user:{freeze:function(e,a){o.post(_uri("system/user/freeze"),e,a)},list:function(e,a){o.post(_uri("system/user/list"),e,a)},save:function(e,a){o.post(_uri("system/user/save"),e,a)},"delete":function(e,a){o.post(_uri("system/user/delete"),e,a)},getUser:function(e,a){o.post(_uri("system/user/getUser"),e,a)}},email:{sendValEmail:function(e,a){o.post(_uri("system/email/sendValEmail"),e,a)},valEmail:function(e,a){o.post(_uri("system/email/valEmail"),e,a)},existEmail:function(e,a){o.post(_uri("system/email/existEmail"),e,a)}},log:{list:function(e,a){o.post(_uri("system/log/list"),e,a)},browser:function(e){o.post(_uri("system/log/browser"),null,e)},data:function(e){o.post(_uri("system/log/data"),null,e)},error:function(e){o.post(_uri("system/log/error"),null,e)},chart:function(e){o.post(_uri("system/log/chart"),null,e)}},bug:{list:function(e,a){o.post(_uri("system/bug/list"),e,a)},save:function(e,n){var m=a.toParam("bug",e);o.post(_uri("system/bug/save"),m,n)},"delete":function(e,a){o.post(_uri("system/bug/delete"),e,a)},status:function(e,a){o.post(_uri("system/bug/status"),e,a)}}};return o}]),systemModule.factory("D",["$rootScope",function(){var e={icons:[{name:"am-icon-at"},{name:"am-icon-bell-slash"},{name:"am-icon-bell-slash-o"},{name:"am-icon-bicycle"},{name:"am-icon-binoculars"},{name:"am-icon-birthday-cake"},{name:"am-icon-futbol-o"},{name:"am-icon-google-wallet"},{name:"am-icon-ils"},{name:"am-icon-ioxhost"},{name:"am-icon-lastfm"},{name:"am-icon-lastfm-square"},{name:"am-icon-line-chart"},{name:"am-icon-meanpath"},{name:"am-icon-newspaper-o"},{name:"am-icon-paint-brush"},{name:"am-icon-paypal"},{name:"am-icon-pie-chart"},{name:"am-icon-yelp"},{name:"am-icon-anchor"},{name:"am-icon-archive"},{name:"am-icon-area-chart"},{name:"am-icon-arrows"},{name:"am-icon-arrows-h"},{name:"am-icon-arrows-v"},{name:"am-icon-asterisk"},{name:"am-icon-at"},{name:"am-icon-automobile"},{name:"am-icon-ban"},{name:"am-icon-bank"},{name:"am-icon-bar-chart"},{name:"am-icon-bar-chart-o"},{name:"am-icon-barcode"},{name:"am-icon-bookmark"},{name:"am-icon-bookmark-o"},{name:"am-icon-briefcase"},{name:"am-icon-bug"},{name:"am-icon-building"},{name:"am-icon-building-o"},{name:"am-icon-bullhorn"},{name:"am-icon-bullseye"},{name:"am-icon-bus"},{name:"am-icon-cab"},{name:"am-icon-calculator"},{name:"am-icon-calendar"},{name:"am-icon-calendar-o"},{name:"am-icon-cc"},{name:"am-icon-certificate"},{name:"am-icon-check"},{name:"am-icon-check-circle"},{name:"am-icon-check-circle-o"},{name:"am-icon-check-square"},{name:"am-icon-check-square-o"},{name:"am-icon-child"},{name:"am-icon-circle"},{name:"am-icon-circle-o"},{name:"am-icon-circle-o-notch"},{name:"am-icon-circle-thin"},{name:"am-icon-clock-o"},{name:"am-icon-close"},{name:"am-icon-cloud"},{name:"am-icon-compass"},{name:"am-icon-copyright"},{name:"am-icon-credit-card"},{name:"am-icon-crop"},{name:"am-icon-crosshairs"},{name:"am-icon-cube"},{name:"am-icon-cubes"},{name:"am-icon-cutlery"},{name:"am-icon-dashboard"},{name:"am-icon-database"},{name:"am-icon-desktop"},{name:"am-icon-dot-circle-o"},{name:"am-icon-download"},{name:"am-icon-edit"},{name:"am-icon-ellipsis-h"},{name:"am-icon-ellipsis-v"},{name:"am-icon-envelope"},{name:"am-icon-exclamation"},{name:"am-icon-exclamation-circle"},{name:"am-icon-exclamation-triangle"},{name:"am-icon-external-link"},{name:"am-icon-external-link-square"},{name:"am-icon-eye"},{name:"am-icon-eye-slash"},{name:"am-icon-eyedropper"},{name:"am-icon-fax"},{name:"am-icon-female"},{name:"am-icon-fighter-jet"},{name:"am-icon-file-archive-o"},{name:"am-icon-file-audio-o"},{name:"am-icon-file-code-o"},{name:"am-icon-file-excel-o"},{name:"am-icon-file-image-o"},{name:"am-icon-fire"},{name:"am-icon-fire-extinguisher"},{name:"am-icon-flag"},{name:"am-icon-flag-checkered"},{name:"am-icon-flag-o"},{name:"am-icon-flash"},{name:"am-icon-flask"},{name:"am-icon-folder"},{name:"am-icon-folder-o"},{name:"am-icon-folder-open"},{name:"am-icon-home"},{name:"am-icon-eur"},{name:"am-icon-euro"},{name:"am-icon-gbp"},{name:"am-icon-ils"},{name:"am-icon-inr"},{name:"am-icon-jpy"},{name:"am-icon-krw"},{name:"am-icon-money"},{name:"am-icon-file-text-o"},{name:"am-icon-files-o"},{name:"am-icon-floppy-o"},{name:"am-icon-font"},{name:"am-icon-header"},{name:"am-icon-indent"},{name:"am-icon-italic"},{name:"am-icon-link"},{name:"am-icon-list"},{name:"am-icon-list-alt"},{name:"am-icon-list-ol"},{name:"am-icon-user-md"},{name:"am-icon-wheelchair"}]};return e}]);
;/*!/system/static/js/userCtrl.js*/
systemModule.controller("userCtrl",["$scope","$rootScope","$stateParams","$window","api","D","jbase","NgTableParams",function(e,i,t,a,l,o,n,s){i.reset(function(){l.user.delete({id:i.delId},function(){e.tableParams.reload()})}),e.tableParams=new s({page:1,count:10},{getData:function(i,t){l.user.list(t.$params,function(t){e.list=t.data.list,i.resolve(e.list)})}}),e.edit=function(e){a.location.href="#/system/user.edit?id="+e.id},e.freeze=function(i){l.user.freeze({id:i.id,status:i.status},function(){e.tableParams.reload()})}}]),systemModule.controller("userEditCtrl",["$scope","$rootScope","$stateParams","$window","api","D","jbase",function(e,i,t,a,l,o,n){e.title="新增用户",e.modal=!1,e.modalPwd=!1,e.modalEmail=!1,e.emailError=!1,e.resend=!0,e.time=60,e.f={icon:_uri("system/static/i/10.jpg")},l.role.list(function(i){e.roles=i}),t.id&&(e.title="编辑用户",l.user.getUser({id:t.id},function(i){e.f=i.data,e.f.role_ids&&(e.f.role_ids=parseInt(e.f.role_ids)),console.log(e.f)})),e.setIcon=function(i){e.modal=!1,e.f.icon=_uri("system/static/i/")+i+".jpg"},e.submit=function(){var i=n.toParam("user",e.f,["role_ids"]);l.user.save(i,function(i){200==i.code&&(e.f.id?a.location.href="#/system/user":e.reSendEmail())})},e.reSendEmail=function(i){var t=function(){e.time>0?(e.time--,n.delay(t,null,1e3)):(e.time=null,e.resend=!1)};l.email.sendValEmail({email:i},function(){e.resend=!0,i||(e.modalEmail=!0),e.time=60,t()})},e.showModalPwd=function(){e.reSendEmail(e.f.email),e.modalPwd=!0},e.modifyPwd=function(){e.valEmail(function(){e.f.pwd=e.pwd,e.modalPwd=!1})},e.checkEmail=function(i){return e.f.email&&$(i.field).is(".email")?$.ajax({url:_uri("system/email/existEmail?email=")+e.f.email,dataType:"json"}).then(function(e){return i.valid=200==e.code?!0:!1,i},function(){return i.valid=!1,i}):void 0},e.valEmail=function(i){l.email.valEmail({val:e.val},function(t){e.modalEmail=!1,200==t.code&&(i||n.delay(function(){a.location.href="#/system/user"},null,555),console.log(i),i&&i(t),e.val=null)})}}]);